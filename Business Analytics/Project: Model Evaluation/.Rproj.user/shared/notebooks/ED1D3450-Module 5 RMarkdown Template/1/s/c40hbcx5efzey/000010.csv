"0","# Define revenue and cost"
"0","revenue <- 100"
"0","cost <- 25"
"0",""
"0","# Make plot"
"0","d %>%"
"0","  mutate(probability = predict(tree_model, type=""prob"")[,2]) %>%"
"0","  arrange(desc(probability)) %>%"
"0","  mutate(profit = ifelse(purchased == ""yes"", revenue - cost, -cost),"
"0","         cum_profit = cumsum(profit),"
"0","         customers = 1:n() / n()) %>%"
"0","  ggplot(aes(customers, cum_profit)) + "
"0","  geom_line() + "
"0","  ggtitle(""Profit curve for tree classifier of purchase in AdviseInvest case"") + "
"0","  xlab(""proportion of customers (decreasing by score)"") + "
"0","  ylab(""cumulative profit"") + "
"0","  theme_minimal()"
"0",""
